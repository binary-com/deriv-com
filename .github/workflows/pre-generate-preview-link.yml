name: Pre-generate preview link

permissions:
    pull-requests: write

on:
    pull_request:
        types: [opened, synchronize]
concurrency:
    group: 'cloudflare-pages-verify-${{ github.head_ref }}'
    cancel-in-progress: true

jobs:
    verify_pull_request:
        runs-on: ubuntu-20.04
        steps:
            - name: Retrieve PR information
              env:
                  EVENT_NUMBER: ${{ github.event.number }}
                  EVENT_USERNAME: ${{ github.event.pull_request.user.login }}
                  HEAD_REF: ${{ github.head_ref }}
              run: |
echo "PR Number: $EVENT_NUMBER" && echo "Author: $EVENT_USERNAME"

            - name: Upload PR information to artifact
              env:
                  RUN_ID: ${{ github.run_id }}
              uses: actions/upload-artifact@v2
              with:
                  name: pr-artifact-${{ github.event.number }}
                  path: pr/
