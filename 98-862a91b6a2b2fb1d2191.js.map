{"version":3,"sources":["webpack:///./src/images/svg/livechat-hover.svg","webpack:///./src/components/layout/livechat.js","webpack:///./src/images/svg/livechat.svg","webpack:///./src/components/hooks/use-livechat.js"],"names":["StyledLiveChat","styled","div","props","is_eu_country","css","device","tabletL","tablet","is_banner_shown","tabletS","mobileM","LiveChat","React","useState","is_livechat_hover","setLivechatHover","useLivechat","is_livechat_interactive","LC_API","useContext","DerivStore","className","onClick","open_chat_window","onMouseEnter","onMouseLeave","src","alt","setLiveChatInteractive","isBrowser","window","is_logged_in","setLoggedIn","is_livechat_query","URLSearchParams","location","search","get","useEffect","cookie_interval","script_timeout","domain","getDomain","setInterval","client_information","getClientInformation","setTimeout","callback","livechat_script","LiveChatWidget","on","toLowerCase","document","createElement","innerHTML","body","appendChild","clearInterval","clearTimeout","utm_data","getUTMData","utm_source","utm_medium","utm_campaign","loginid","email","landing_company_shortcode","currency","residence","first_name","last_name","session_variables","call","on_chat_ended"],"mappings":"oJAyBe,I,wBChBTA,EAAiBC,IAAOC,IAAV,+EAAGD,CAAH,mOAEN,SAACE,GAAD,OAAYA,EAAMC,cAAgB,OAAS,YASnD,SAACD,GACC,GAAIA,EAAMC,cACN,OAAOC,YAAP,6LAIaC,IAAOC,QAGPD,IAAOE,QACF,SAACL,GAAD,OAAYA,EAAMM,gBAAkB,QAAU,UAGnDH,IAAOI,SACF,SAACP,GAAD,OAAYA,EAAMM,gBAAkB,QAAU,WAG9C,SAACN,GAAD,OAAYA,EAAMM,gBAAkB,QAAU,UAEnDH,IAAOK,SACF,SAACR,GAAD,OAAYA,EAAMM,gBAAkB,QAAU,cA2C7DG,UApCE,SAAC,GAAyB,IAAvBH,EAAsB,EAAtBA,gBAAsB,EACQI,IAAMC,UAAS,GAAtDC,EAD+B,KACZC,EADY,OAEIC,cAAnCC,EAF+B,KAENC,EAFM,KAG9Bf,EAAkBS,IAAMO,WAAWC,KAAnCjB,cAER,OACI,oCACKc,GACG,kBAAClB,EAAD,CACIsB,UAAU,qBACVb,gBAAiBA,EACjBL,cAAeA,EACfmB,QAAS,WACLJ,EAAOK,oBAEXC,aAAc,kBAAMT,GAAiB,IACrCU,aAAc,kBAAMV,GAAiB,KAEpCD,EACG,yBAAKY,IDzCd,quBCyCkCC,IAAI,kBAE7B,yBAAKD,ICnDd,i3BDmD+BC,IAAI,sB,kCEpElD,uEAGaX,EAAc,WAAO,IAAD,EAC6BJ,IAAMC,UAAS,GAAlEI,EADsB,KACGW,EADH,KAEvBV,EAAUW,eAAeC,OAAOZ,QAAW,GAFpB,EAGON,IAAMC,UAAS,GAA5CkB,EAHsB,KAGRC,EAHQ,KAMvBC,EADa,IAAIC,gBAAiBL,eAAeC,OAAOK,SAASC,QAAW,IAC7CC,IAAI,oBA+GzC,OAlGAzB,IAAM0B,WAAU,WACZ,IAAIC,EAAkB,KAClBC,EAAiB,KACrB,GAAIX,cAAa,CACb,IAAMY,EAASC,cASfH,EAAkBI,aALP,WACH,IAAMC,EAAqBC,YAAqBJ,GAChDT,IAAcY,KAGqB,KAG3CJ,EAAiBM,YAAW,WA3BT,IAACC,EAClBC,EADkBD,EA4BG,WACfjB,OAAOmB,eAAeC,GAAG,SAAS,WAC9BtB,GAAuB,GACkB,UAArCK,aAAA,EAAAA,EAAmBkB,gBACnBrB,OAAOZ,OAAOK,wBA/B5ByB,EAAkBI,SAASC,cAAc,WAC/BC,UAAhB,kxBAKAF,SAASG,KAAKC,YAAYR,GACtBD,GAAUA,MA4BP,KAGP,OAAO,WACHU,cAAclB,GACdmB,aAAalB,MAElB,IAEH5B,IAAM0B,WAAU,WACZ,GAAIT,cAAa,CACb,IAAMY,EAASC,cACXzB,GACAa,OAAOmB,eAAeC,GAAG,SAAS,WAC9B,IAAMS,EAAWC,YAAWnB,GACtBG,EAAqBC,YAAqBJ,GAFZ,EAIakB,GAAY,GAArDE,EAJ4B,EAI5BA,WAAYC,EAJgB,EAIhBA,WAAYC,EAJI,EAIJA,aAJI,EAchCnB,GAAsB,GAPtBoB,EAPgC,EAOhCA,QACAC,EARgC,EAQhCA,MACAC,EATgC,EAShCA,0BACAC,EAVgC,EAUhCA,SACAC,EAXgC,EAWhCA,UACAC,EAZgC,EAYhCA,WACAC,EAbgC,EAahCA,UAKEC,EAAoB,CACtBxC,aAAcA,EACdiC,QAASA,UAAW,GACpBE,0BAA2BA,UAA6B,GACxDC,SAAUA,UAAY,GACtBC,UAAWA,UAAa,GACxBH,MAAOA,UAAS,GAChBJ,WAAYA,UAAc,GAC1BC,WAAYA,UAAc,GAC1BC,aAAcA,UAAgB,IAGlCjC,OAAOmB,eAAeuB,KAAK,wBAAyBD,GAEhDxC,GACIkC,GACAnC,OAAOmB,eAAeuB,KAAK,qBAAsBP,GAEjDI,GAAcC,GACdxC,OAAOmB,eAAeuB,KAClB,oBACGH,EAFP,IAEqBC,IAKzBxC,OAAOZ,OAAOuD,cAAgB,WAC1B3C,OAAOmB,eAAeuB,KAAK,qBAAsB,KACjD1C,OAAOmB,eAAeuB,KAAK,oBAAqB,MAIxD,IACMvC,EADa,IAAIC,gBAAgBJ,OAAOK,SAASC,QAClBC,IAAI,oBACA,UAArCJ,aAAA,EAAAA,EAAmBkB,gBACnBrB,OAAOZ,OAAOK,yBAK/B,CAACQ,EAAcd,IAEX,CAACA,EAAyBC","file":"98-862a91b6a2b2fb1d2191.js","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nvar _ref = /*#__PURE__*/React.createElement(\"g\", {\n  fill: \"none\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"#85ACB0\",\n  d: \"M21 2H3a3 3 0 00-3 3v16l.006.114c.087.814 1.099 1.196 1.701.593L5.414 18H21a3 3 0 003-3V5a3 3 0 00-3-3z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"#85ACB0\",\n  d: \"M26 10v6c0 2.21-1.79 4-4 4H8v3a3 3 0 002.824 2.995L11 26h15.586l3.707 3.707c.602.603 1.614.22 1.701-.593L32 29V13a3 3 0 00-2.824-2.995L29 10h-3z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"#FFF\",\n  d: \"M11 10a1 1 0 01.117 1.993L11 12H7a1 1 0 01-.117-1.993L7 10h4zm6-4a1 1 0 01.117 1.993L17 8H7a1 1 0 01-.117-1.993L7 6h10z\"\n}));\n\nfunction SvgLivechatHover(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 32,\n    height: 32\n  }, props), _ref);\n}\n\nexport default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiI+PGcgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzg1QUNCMCIgZD0iTTIxIDJIM2EzIDMgMCAwMC0zIDN2MTZsLjAwNi4xMTRjLjA4Ny44MTQgMS4wOTkgMS4xOTYgMS43MDEuNTkzTDUuNDE0IDE4SDIxYTMgMyAwIDAwMy0zVjVhMyAzIDAgMDAtMy0zeiIvPjxwYXRoIGZpbGw9IiM4NUFDQjAiIGQ9Ik0yNiAxMHY2YzAgMi4yMS0xLjc5IDQtNCA0SDh2M2EzIDMgMCAwMDIuODI0IDIuOTk1TDExIDI2aDE1LjU4NmwzLjcwNyAzLjcwN2MuNjAyLjYwMyAxLjYxNC4yMiAxLjcwMS0uNTkzTDMyIDI5VjEzYTMgMyAwIDAwLTIuODI0LTIuOTk1TDI5IDEwaC0zeiIvPjxwYXRoIGZpbGw9IiNGRkYiIGQ9Ik0xMSAxMGExIDEgMCAwMS4xMTcgMS45OTNMMTEgMTJIN2ExIDEgMCAwMS0uMTE3LTEuOTkzTDcgMTBoNHptNi00YTEgMSAwIDAxLjExNyAxLjk5M0wxNyA4SDdhMSAxIDAgMDEtLjExNy0xLjk5M0w3IDZoMTB6Ii8+PC9nPjwvc3ZnPg==\";\nexport { SvgLivechatHover as ReactComponent };","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled, { css } from 'styled-components'\nimport { useLivechat } from 'components/hooks/use-livechat'\nimport LiveChatIC from 'images/svg/livechat.svg'\nimport LiveChatHover from 'images/svg/livechat-hover.svg'\nimport device from 'themes/device'\nimport { DerivStore } from 'store'\n\nconst StyledLiveChat = styled.div`\n    position: fixed;\n    bottom: ${(props) => (props.is_eu_country ? '9rem' : '1.6rem')};\n    right: 1.6rem;\n    background-color: var(--color-white);\n    box-shadow: 0 16px 20px 0 rgba(0, 0, 0, 0.05), 0 0 20px 0 rgba(0, 0, 0, 0.05);\n    padding: 1.6rem;\n    display: flex;\n    cursor: pointer;\n    border-radius: 50%;\n    z-index: 999;\n    ${(props) => {\n        if (props.is_eu_country) {\n            return css`\n                @media (max-width: 1269px) {\n                    bottom: 11rem;\n                }\n                @media ${device.tabletL} {\n                    bottom: 14rem;\n                }\n                @media ${device.tablet} {\n                    bottom: ${(props) => (props.is_banner_shown ? '29rem' : '14rem')};\n                    padding: 1rem;\n                }\n                @media ${device.tabletS} {\n                    bottom: ${(props) => (props.is_banner_shown ? '28rem' : '13rem')};\n                }\n                @media (max-width: 538px) {\n                    bottom: ${(props) => (props.is_banner_shown ? '30rem' : '15rem')};\n                }\n                @media ${device.mobileM} {\n                    bottom: ${(props) => (props.is_banner_shown ? '32rem' : '16rem')};\n                }\n            `\n        }\n    }}\n`\n\nconst LiveChat = ({ is_banner_shown }) => {\n    const [is_livechat_hover, setLivechatHover] = React.useState(false)\n    const [is_livechat_interactive, LC_API] = useLivechat()\n    const { is_eu_country } = React.useContext(DerivStore)\n\n    return (\n        <>\n            {is_livechat_interactive && (\n                <StyledLiveChat\n                    className=\"gtm-deriv-livechat\"\n                    is_banner_shown={is_banner_shown}\n                    is_eu_country={is_eu_country}\n                    onClick={() => {\n                        LC_API.open_chat_window()\n                    }}\n                    onMouseEnter={() => setLivechatHover(true)}\n                    onMouseLeave={() => setLivechatHover(false)}\n                >\n                    {is_livechat_hover ? (\n                        <img src={LiveChatHover} alt=\"livechat icon\" />\n                    ) : (\n                        <img src={LiveChatIC} alt=\"livechat icon\" />\n                    )}\n                </StyledLiveChat>\n            )}\n        </>\n    )\n}\n\nLiveChat.propTypes = {\n    is_banner_shown: PropTypes.bool,\n    is_livechat_interactive: PropTypes.bool,\n    LC_API: PropTypes.object,\n    setLiveChatInteractive: PropTypes.func,\n}\n\nexport default LiveChat\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nvar _ref = /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"#85ACB0\",\n  d: \"M29 10l.176.005A3 3 0 0132 13v16l-.006.114c-.087.814-1.099 1.196-1.701.593L26.586 26H11l-.176-.005A3 3 0 018 23v-3h2v3l.007.117A1 1 0 0011 24h16l.131.009c.217.028.42.128.576.284L30 26.584V13l-.007-.117A1 1 0 0029 12h-3v-2h3zm-8-8a3 3 0 013 3v10a3 3 0 01-3 3H5.414l-3.707 3.707c-.602.603-1.614.22-1.701-.593L0 21V5a3 3 0 013-3zm0 2H3a1 1 0 00-1 1v13.584l2.293-2.291a.996.996 0 01.576-.284L5 16h16a1 1 0 001-1V5a1 1 0 00-1-1zm-10 6a1 1 0 01.117 1.993L11 12H7a1 1 0 01-.117-1.993L7 10h4zm6-4a1 1 0 01.117 1.993L17 8H7a1 1 0 01-.117-1.993L7 6h10z\"\n});\n\nfunction SvgLivechat(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 32,\n    height: 32\n  }, props), _ref);\n}\n\nexport default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiI+PHBhdGggZmlsbD0iIzg1QUNCMCIgZD0iTTI5IDEwbC4xNzYuMDA1QTMgMyAwIDAxMzIgMTN2MTZsLS4wMDYuMTE0Yy0uMDg3LjgxNC0xLjA5OSAxLjE5Ni0xLjcwMS41OTNMMjYuNTg2IDI2SDExbC0uMTc2LS4wMDVBMyAzIDAgMDE4IDIzdi0zaDJ2M2wuMDA3LjExN0ExIDEgMCAwMDExIDI0aDE2bC4xMzEuMDA5Yy4yMTcuMDI4LjQyLjEyOC41NzYuMjg0TDMwIDI2LjU4NFYxM2wtLjAwNy0uMTE3QTEgMSAwIDAwMjkgMTJoLTN2LTJoM3ptLTgtOGEzIDMgMCAwMTMgM3YxMGEzIDMgMCAwMS0zIDNINS40MTRsLTMuNzA3IDMuNzA3Yy0uNjAyLjYwMy0xLjYxNC4yMi0xLjcwMS0uNTkzTDAgMjFWNWEzIDMgMCAwMTMtM3ptMCAySDNhMSAxIDAgMDAtMSAxdjEzLjU4NGwyLjI5My0yLjI5MWEuOTk2Ljk5NiAwIDAxLjU3Ni0uMjg0TDUgMTZoMTZhMSAxIDAgMDAxLTFWNWExIDEgMCAwMC0xLTF6bS0xMCA2YTEgMSAwIDAxLjExNyAxLjk5M0wxMSAxMkg3YTEgMSAwIDAxLS4xMTctMS45OTNMNyAxMGg0em02LTRhMSAxIDAgMDEuMTE3IDEuOTkzTDE3IDhIN2ExIDEgMCAwMS0uMTE3LTEuOTkzTDcgNmgxMHoiLz48L3N2Zz4=\";\nexport { SvgLivechat as ReactComponent };","import React from 'react'\nimport { getClientInformation, getDomain, getUTMData, isBrowser } from 'common/utility'\n\nexport const useLivechat = () => {\n    const [is_livechat_interactive, setLiveChatInteractive] = React.useState(false)\n    const LC_API = (isBrowser() && window.LC_API) || {}\n    const [is_logged_in, setLoggedIn] = React.useState(false)\n\n    const url_params = new URLSearchParams((isBrowser() && window.location.search) || '')\n    const is_livechat_query = url_params.get('is_livechat_open')\n\n    const loadLiveChatScript = (callback) => {\n        const livechat_script = document.createElement('script')\n        livechat_script.innerHTML = `\n            window.__lc = window.__lc || {};\n            window.__lc.license = 12049137;\n            ;(function(n,t,c){function i(n){return e._h?e._h.apply(null,n):e._q.push(n)}var e={_q:[],_h:null,_v:\"2.0\",on:function(){i([\"on\",c.call(arguments)])},once:function(){i([\"once\",c.call(arguments)])},off:function(){i([\"off\",c.call(arguments)])},get:function(){if(!e._h)throw new Error(\"[LiveChatWidget] You canâ€™t use getters before load.\");return i([\"get\",c.call(arguments)])},call:function(){i([\"call\",c.call(arguments)])},init:function(){var n=t.createElement(\"script\");n.async=!0,n.type=\"text/javascript\",n.src=\"https://cdn.livechatinc.com/tracking.js\",t.head.appendChild(n)}};!n.__lc.asyncInit&&e.init(),n.LiveChatWidget=n.LiveChatWidget||e}(window,document,[].slice))\n        `\n        document.body.appendChild(livechat_script)\n        if (callback) callback()\n    }\n\n    React.useEffect(() => {\n        let cookie_interval = null\n        let script_timeout = null\n        if (isBrowser()) {\n            const domain = getDomain()\n\n            /* this function runs every second to determine logged in status*/\n            const checkCookie = (() => {\n                return function () {\n                    const client_information = getClientInformation(domain)\n                    setLoggedIn(!!client_information)\n                }\n            })()\n            cookie_interval = setInterval(checkCookie, 1000)\n\n            // The purpose is to load the script after everything is load but not async or defer. Therefore, it will be ignored in the rendering timeline\n            script_timeout = setTimeout(() => {\n                loadLiveChatScript(() => {\n                    window.LiveChatWidget.on('ready', () => {\n                        setLiveChatInteractive(true)\n                        if (is_livechat_query?.toLowerCase() === 'true') {\n                            window.LC_API.open_chat_window()\n                        }\n                    })\n                })\n            }, 2000)\n        }\n\n        return () => {\n            clearInterval(cookie_interval)\n            clearTimeout(script_timeout)\n        }\n    }, [])\n\n    React.useEffect(() => {\n        if (isBrowser()) {\n            const domain = getDomain()\n            if (is_livechat_interactive) {\n                window.LiveChatWidget.on('ready', () => {\n                    const utm_data = getUTMData(domain)\n                    const client_information = getClientInformation(domain)\n\n                    const { utm_source, utm_medium, utm_campaign } = utm_data || {}\n\n                    const {\n                        loginid,\n                        email,\n                        landing_company_shortcode,\n                        currency,\n                        residence,\n                        first_name,\n                        last_name,\n                    } = client_information || {}\n\n                    /* the session variables are sent to CS team dashboard to notify user has logged in\n                    and also acts as custom variables to trigger targeted engagement */\n                    const session_variables = {\n                        is_logged_in: is_logged_in,\n                        loginid: loginid ?? '',\n                        landing_company_shortcode: landing_company_shortcode ?? '',\n                        currency: currency ?? '',\n                        residence: residence ?? '',\n                        email: email ?? '',\n                        utm_source: utm_source ?? '',\n                        utm_medium: utm_medium ?? '',\n                        utm_campaign: utm_campaign ?? '',\n                    }\n\n                    window.LiveChatWidget.call('set_session_variables', session_variables)\n\n                    if (is_logged_in) {\n                        if (email) {\n                            window.LiveChatWidget.call('set_customer_email', email)\n                        }\n                        if (first_name && last_name) {\n                            window.LiveChatWidget.call(\n                                'set_customer_name',\n                                `${first_name} ${last_name}`,\n                            )\n                        }\n                    } else {\n                        // clear name and email fields after chat has ended\n                        window.LC_API.on_chat_ended = () => {\n                            window.LiveChatWidget.call('set_customer_email', ' ')\n                            window.LiveChatWidget.call('set_customer_name', ' ')\n                        }\n                    }\n\n                    const url_params = new URLSearchParams(window.location.search)\n                    const is_livechat_query = url_params.get('is_livechat_open')\n                    if (is_livechat_query?.toLowerCase() === 'true') {\n                        window.LC_API.open_chat_window()\n                    }\n                })\n            }\n        }\n    }, [is_logged_in, is_livechat_interactive])\n\n    return [is_livechat_interactive, LC_API]\n}\n"],"sourceRoot":""}